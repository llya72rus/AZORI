$(document).ready(function() {

  /*
    Очень-очень плохой код
  */

  $('#card-1 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-1 .card__colors'
  });

  $('#card-1 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-1 .card__images',
    focusOnSelect: true,
  });

  $('#card-2 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-2 .card__colors'
  });

  $('#card-2 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-2 .card__images',
    focusOnSelect: true,
  });

  $('#card-3 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-3 .card__colors'
  });

  $('#card-3 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-3 .card__images',
    focusOnSelect: true,
  });

  $('#card-4 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-4 .card__colors'
  });

  $('#card-4 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-4 .card__images',
    focusOnSelect: true,
  });

  $('#card-5 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-5 .card__colors'
  });

  $('#card-5 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-5 .card__images',
    focusOnSelect: true,
  });

  $('#card-6 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-6 .card__colors'
  });

  $('#card-6 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-6 .card__images',
    focusOnSelect: true,
  });

  $('#card-7 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-7 .card__colors'
  });

  $('#card-7 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-7 .card__images',
    focusOnSelect: true,
  });

  $('#card-8 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-8 .card__colors'
  });

  $('#card-8 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-8 .card__images',
    focusOnSelect: true,
  });

  $('#card-9 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-9 .card__colors'
  });

  $('#card-9 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-9 .card__images',
    focusOnSelect: true,
  });

  $('#card-10 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-10 .card__colors'
  });

  $('#card-10 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-10 .card__images',
    focusOnSelect: true,
  });

  $('#card-11 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-11 .card__colors'
  });

  $('#card-11 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-11 .card__images',
    focusOnSelect: true,
  });

  $('#card-12 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-12 .card__colors'
  });

  $('#card-12 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-12 .card__images',
    focusOnSelect: true,
  });

  $('#card-13 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-13 .card__colors'
  });

  $('#card-13 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-13 .card__images',
    focusOnSelect: true,
  });

  $('#card-14 .card__images').slick({
    speed: 500,
    arrows: false,
    slidesToShow:  1,
    slidesToScroll: 1,
    asNavFor: '#card-14 .card__colors'
  });

  $('#card-14 .card__colors').slick({
    speed: 500,
    slidesToShow: 3,
    slidesToScroll: 1,
    infinite: false,
    draggable: false,
    asNavFor: '#card-14 .card__images',
    focusOnSelect: true,
  });

  /*
      Конец  очень-очень плохого кода
  */

  // Слайдеры

  $('.about__slick').slick({
    dots: false,
    arrows: true,
    infinite: true,
    speed: 300,
    slidesToShow: 4,
    slidesToScroll: 1,
    responsive: [
      {
        breakpoint: 1025,
        settings: {
          slidesToShow: 2,
          centerMode: true,
          centerPadding: '72px'
        }
      },

      {
        breakpoint: 768,
        settings: {
          slidesToShow: 2,
          centerMode: true,
          centerPadding: '10%',
          arrows: false,
          dots: true
        }
      },

      {
        breakpoint: 670,
        settings: {
          slidesToShow: 1,
          centerMode: true,
          centerPadding: '50px',
          arrows: false,
          dots: true
        }
      },

      {
        breakpoint: 375,
        settings: {
          slidesToShow: 1,
          centerMode: true,
          centerPadding: '25px',
          arrows: false,
          dots: true
        }
      }
    ]
  });

  $('.main-header__slick').slick({
    dots: true,
    arrows: true,
    infinite: true,
    speed: 600,
    centerMode: true,
    centerPadding: '21.2%',
    slidesToShow: 1,
    slidesToScroll: 1,
    nextArrow: '<button type="button" class="main-header__slick-next">Next</button>',
    prevArrow: '<button type="button" class="main-header__slick-prev">Previous</button>',
    responsive: [
      {
        breakpoint: 1600,
        settings: {
          centerPadding: '15%'
        }
      },

    {
      breakpoint: 1300,
      settings: {
        centerPadding: '12%'
      }
    },

    {
      breakpoint: 1025,
      settings: {
        centerPadding: '9%'
      }
    },

    {
      breakpoint: 769,
      settings: {
        centerPadding: '11.5%'
      }
    },

    {
      breakpoint: 767,
      settings: {
        centerPadding: '0',
        centerMode: false
      }
    },
  ]
  });


  $('.news__list').slick({
    mobileFirst: true,
    arrows: false,
    dots: true,
    // fade: true,
    adaptiveHeight: true,
    responsive: [

      {
        breakpoint: 670,
        settings: 'unslick'
      }
    ]
  });

  $('.catalog-top-slider').slick({
    speed: 500,
    useTransform: false,
    nextArrow: '<button type="button" class="catalog-top-slider__next">Next</button>',
    prevArrow: '<button type="button" class="catalog-top-slider__prev">Previous</button>',
  });

  $('.collection__gallery').slick({
    speed: 500,
    slidesToShow:  1,
    slidesToScroll: 1,
    infinite: true,
    arrows: true,
    nextArrow: '<button type="button" class="collection__gallery-next">Next</button>',
    prevArrow: '<button type="button" class="collection__gallery-prev">Previous</button>'
  });

  $('.coll-examples__slider').slick({
    speed: 500,
    slidesToShow:  4,
    slidesToScroll: 1,
    infinite: true,
    arrows: true,
    nextArrow: '<button type="button" class="coll-examples__slide-next">Next</button>',
    prevArrow: '<button type="button" class="coll-examples__slide-prev">Previous</button>',
    responsive: [

      {
        breakpoint: 1280,
        settings: {
          slidesToShow: 3
        }
      },

      {
        breakpoint: 1024,
        settings: {
          slidesToShow: 2,
          dots: true,
          arrows: false
        }
      },

      {
        breakpoint: 670,
        settings: {
          slidesToShow: 1,
          arrows: false,
          dots: true,
        }
      }

    ]
  });

  $('.recommended__wrapper').slick({
    speed: 500,
    slidesToShow:  3,
    slidesToScroll: 1,
    infinite: true,
    arrows: true,
    nextArrow: '<button type="button" class="orange-rounded-btn-next">Next</button>',
    prevArrow: '<button type="button" class="orange-rounded-btn-prev">Previous</button>',
    responsive: [

      {
        breakpoint: 1366,
        settings: {
          variableWidth: false,
          slidesToShow: 2,
          arrows: false,
          dots: true
        }
      },

      {
        breakpoint: 670,
        settings: {
          variableWidth: false,
          slidesToShow: 1,
          arrows: false,
          dots: true,
        }
      }

    ]
  });

  $('.viewed__wrapper').slick({
    speed: 500,
    slidesToShow:  2,
    slidesToScroll: 1,
    infinite: true,
    arrows: true,
    nextArrow: '<button type="button" class="orange-rounded-btn-next">Next</button>',
    prevArrow: '<button type="button" class="orange-rounded-btn-prev">Previous</button>',
    responsive: [

      {
        breakpoint: 1366,
        settings: {
          variableWidth: false,
          arrows: false,
          dots: true
        }
      },

      {
        breakpoint: 670,
        settings: {
          variableWidth: false,
          slidesToShow: 1,
          arrows: false,
          dots: true,
        }
      }
    ]
  });


  $('.collection__colors-list').slick({
    speed: 500,
    slidesToShow:  4,
    slidesToScroll: 1,
    infinite: true,
    arrows: false,
    dots: true,
    focusOnSelect: true,

    responsive: [

      {
        breakpoint: 767,
        settings: {
          slidesToShow: 3,
          infinite: true
        }

      }
    ]
  });


   // Мобильное меню

  (function () {

    $('.main-header .menu-toggle').click(function() {
      $(this).toggleClass('open');
      $('.main-nav').toggleClass('main-nav--show');
      $('.mobile-header').toggleClass('mobile-header--menu-opened');

    });


    $('.page-nav .menu-toggle').click(function() {
      $(this).toggleClass('open');
      $('.page-nav').toggleClass('page-nav--menu-opened');
      $('.page-nav__list').toggleClass('page-nav__list--show');
    });

  })();

  // $('.news__desc').readmore({
  //   speed: 75,
  //   collapsedHeight: 150,
  //   moreLink: '<a class="news__readmore" href="#">Читать полностью</a>',
  // });

$('.news__desc').each(function() {
    var ths = $(this);
   if(ths.height()>130){
       ths.addClass('news__desc--ellipsis');
   }
});
  // Аккордион

  (function () {

    var showFilter = document.querySelector(".catalog__collapse-filter");
    $(".catalog__collapse-filter").click(function() {
      $(this).toggleClass("catalog__collapse-filter--active");

      var panel = this.nextElementSibling;
      if (panel.style.display === "block") {
          panel.style.display = "none";
      } else {
          panel.style.display = "block";
      }
    });

    var acc = document.querySelectorAll(".acc-toggle");

    for (var i = 0; i < acc.length; i++) {
      acc[i].addEventListener("click", function() {
        this.classList.toggle("acc-toggle--active");
        var panel = this.nextElementSibling;
        if (panel.style.maxHeight){
          panel.style.maxHeight = null;
        } else {
          panel.style.maxHeight = panel.scrollHeight + "px";
        }
      });
    }
  })();

  // Замена текста кнопки скрыть/раскрыть фильтр при клике на нее

  $('.catalog__collapse-filter').click(function () {
    if ($(this).hasClass('catalog__collapse-filter--active')) {
      $(this).text('Скрыть текст')
    } else {
      $(this).text('Раскрыть текст');
    }
  });

  // Закрываем всплывающее окно на странице отдельной коллекции

  function openModal () {
    collModal.classList.add('modal--show');
  }

  function closeModal () {
    collModal.classList.remove('modal--show');
  }

  var collModal = document.querySelector('.modal');
  var closeCollModalBtn = document.querySelector('.coll-popup__close-btn');
  var collForm = $('.coll-popup');
  var collElems = document.querySelectorAll('.coll-elems__item');

  if (closeCollModalBtn && collModal) {
    closeCollModalBtn.addEventListener('click', function () {
      collModal.classList.remove('modal--show');
    });
  }

  // for (var i = 0; i < collElems.length; i++) {
  //   if (collElems && closeCollModalBtn) {
  //     collElems[i].addEventListener('click', function (evt) {
  //       evt.preventDefault();
  //       openModal();
  //       collForm.style.top = topScroll;
  //     });
  //   }
  // }

  window.addEventListener('keydown', function (evt) {
    if (evt.keyCode === 27) {
      if (collModal.classList.contains('modal--show')) {
        closeModal();
      }
    }
  });

  window.addEventListener('click', function (evt) {
    if (evt.target === collModal) {
      closeModal();
    }
  });

  $('.search-input-wrap a').on('click', function(e) {
    e.preventDefault();
    var par = $(this).parents('.search-nav');
    var input = par.find('input[type="text"]');
    if (par.hasClass('focused') && input.val().length>0){
      input.parents('form').submit();
    } else {
      par.toggleClass('focused');
      input.focus();
    }
  });

var pageHeight = $(document).height();

$('.modal').css('height', pageHeight);



var topScroll;

$(document).scroll(function() {
  var topScroll = $(document).scrollTop();
});

$('.coll-elems__item').click(function () {
  $('.modal').addClass('modal--show');
  var topScroll = $(document).scrollTop() + ($(window).height() / 2) ;
  $('.coll-popup').css('top', topScroll);
});

var innerHeaderHeight = $('.page-header').height();
$('.inner-body').css('padding-top', innerHeaderHeight);

$(window).resize(function() {
  innerHeaderHeight = $('.page-header').height();
  $('.inner-body').css('padding-top', innerHeaderHeight);
});



  // $('.coll-elems__item').click(function () {
  //   $('.modal').addClass('modal--show');
  // })

  // $('body').mouseup(function() {
  //   if ((!$(this.target).is('.coll-popup')) && (collModal.hasClass('modal--show'))) {
  //     $(collModal).removeClass('modal--show');
  //   }
  // });


  var newsParagraph = $('.news__desc');
  var newsParagraphHeig



  // Функционал кнопки "Наверх"

  if ($('.back-to-top').length) {
    var scrollTrigger = 800, // px
        backToTop = function () {
            var scrollTop = $(window).scrollTop();
            if (scrollTop > scrollTrigger) {
                $('.back-to-top').addClass('show');
            } else {
                $('.back-to-top').removeClass('show');
            }
        };
    backToTop();
    $(window).on('scroll', function () {
        backToTop();
    });
    $('.back-to-top').on('click', function (e) {
        e.preventDefault();
        $('html,body').animate({
            scrollTop: 0
        }, 700);
    });
}

// Белый непрозрачный фон шапки при скролле > 80px

$(window).scroll(function() {
  var top = $(document).scrollTop();
  if (top > 80) {
    $('.main-header__top-header').addClass('main-header__top-header--white-bg');
  } else {
    $('.main-header__top-header').removeClass('main-header__top-header--white-bg');
  }

});

});
